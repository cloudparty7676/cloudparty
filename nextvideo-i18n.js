const i18n = {
  "zh-Hant": {
    meta: {
      title: "NextVideo｜GIS 監控中樞與雲端影像分析",
      desc: "NextVideo｜GIS 地理與監控服務方案，主要提供雲端影像分析、地圖式監控中樞、事件告警與權限管理。"
    },
    nav: {
      homeAria: "NextVideo 首頁",
      aria: "主要導覽",
      mobileAria: "手機導覽",
      langAria: "語言切換",
      menuAria: "開啟選單",
      menu: "選單 ☰",
      subtitle: "GIS × Cloud Video Analytics",
      features: "功能",
      console: "主控台",
      architecture: "架構",
      scenes: "場景",
      contact: "聯絡",
      demo: "預約 Demo"
    },
    hero: {
      pill: "GIS 地理 × 監控影像 × 雲端影像分析",
      title: "用地圖管理影像<br/>用事件管理風險",
      lead: {
        line1: "NextVideo 是以 GIS 為核心的監控與影像分析方案，",
        line2: "將多路攝影機、場域資產與事件告警整合到雲端主控台，支援權限控管與流程串接。"
      },
      actions: {
        console: "看主控台",
        features: "看功能"
      },
      cardAria: "GIS 監控示意",
      cardTag: "Map-first Console（示意）",
      cardTitle: "場域總覽",
      mapAria: "地圖示意（可替換成真實地圖/截圖）",
      badge1: "CAM-021｜入口",
      badge2: "CAM-113｜路口",
      badge3: "CAM-044｜停車區",
      badge4: "事件｜可疑滯留（示意）",
      cardNote: "※ 可替換為你們實際 Console 截圖（地圖、攝影機點位、事件面板）。"
    },
    features: {
      title: "核心功能",
      desc: "把「影像」放到「地理脈絡」中：你不只看到畫面，更知道在哪裡、影響範圍與處置流程。",
      card1: {
        tag: "GIS",
        title: "地圖式資產管理",
        desc: "攝影機、場域、設備、區域…全部落在 GIS，快速定位與管理。",
        list1: "點位/區域/路線",
        list2: "多場域切換",
        list3: "可視化圖層"
      },
      card2: {
        tag: "Video AI",
        title: "雲端影像分析",
        desc: "支援事件偵測與自訂規則，將「異常」變成可追蹤的事件。",
        list1: "事件偵測與標註",
        list2: "時序回放與搜尋",
        list3: "可擴充模型能力"
      },
      card3: {
        tag: "Ops",
        title: "告警與流程串接",
        desc: "把事件推到群組/工單/系統，形成可追蹤的處置流程。",
        list1: "Webhook / 通知整合",
        list2: "事件嚴重度與分派",
        list3: "審計與報表"
      }
    },
    console: {
      title: "主控台設計",
      desc: "主畫面以地圖為中心，旁邊是事件面板與影像牆，讓操作直覺、反應更快。",
      card1: {
        tag: "Map-first",
        title: "地圖＋事件面板",
        desc: "點位、事件、資產關聯一目了然；支援篩選圖層與關鍵字搜尋。",
        list1: "事件列表 / 熱區 / 影響範圍",
        list2: "快速定位攝影機畫面",
        list3: "一鍵導出報表"
      },
      card2: {
        tag: "Video Wall",
        title: "影像牆與回放",
        desc: "多路畫面同時監看，支援時間軸回放與事件片段快速回看。",
        list1: "多路併排 / 自訂佈局",
        list2: "事件切片與標註",
        list3: "取證與留存策略"
      }
    },
    architecture: {
      title: "架構與部署",
      desc: "雲端原生 + 可擴充：可從小規模導入到多場域、多租戶的大型部署。",
      card1: {
        tag: "Security",
        title: "權限與多租戶",
        desc: "依角色與場域控管：誰能看哪個地點、哪支攝影機、哪些事件。"
      },
      card2: {
        tag: "Scale",
        title: "彈性擴充",
        desc: "支援更多點位與更高併發；可依需求調整儲存與分析資源。"
      },
      card3: {
        tag: "Integrations",
        title: "可整合你的系統",
        desc: "事件/點位/影像 Metadata 可透過 API 與 Webhook 串接到既有平台。"
      }
    },
    scenes: {
      title: "適用場景",
      desc: "城市治理、園區管理、工地監控、物流場站、公共安全…只要你需要「地圖＋影像＋事件」就適合。",
      card1: {
        tag: "City",
        title: "城市治理與公共安全",
        desc: "以 GIS 追蹤事件位置、熱區與趨勢，提升應變效率。"
      },
      card2: {
        tag: "Campus",
        title: "園區/廠區管理",
        desc: "場域與資產落在地圖上，事件與告警可追蹤與稽核。"
      },
      card3: {
        tag: "Logistics",
        title: "物流場站與周界",
        desc: "進出點位、車流、人員/車輛異常事件整合管理。"
      }
    },
    cta: {
      title: "想打造 GIS 監控中樞？",
      desc: "我們可以先用一個場域做 PoC，把地圖、點位、事件、告警流程跑起來，再逐步擴充。",
      note: "（此處可改成表單、Email、Line、或聯絡資訊）",
      demo: "預約 Demo",
      back: "回到功能"
    },
    footer: {
      copyright: "© <span id=\"y\"></span> NextVideo. Powered by CloudParty.",
      tagline: "GIS · Cloud Video · Events · Alerts · Access Control"
    }
  },
  en: {
    meta: {
      title: "NextVideo | GIS monitoring console",
      desc: "NextVideo provides cloud video analytics, map-first monitoring, event alerts, and access control."
    },
    nav: {
      homeAria: "NextVideo home",
      aria: "Primary navigation",
      mobileAria: "Mobile navigation",
      langAria: "Language switch",
      menuAria: "Open menu",
      menu: "Menu ☰",
      subtitle: "GIS × Cloud Video Analytics",
      features: "Features",
      console: "Console",
      architecture: "Architecture",
      scenes: "Scenarios",
      contact: "Contact",
      demo: "Book a Demo"
    },
    hero: {
      pill: "GIS × Video monitoring × Cloud analytics",
      title: "Manage video on maps<br/>Manage risk by events",
      lead: {
        line1: "NextVideo is a GIS-first monitoring and video analytics solution, ",
        line2: "bringing cameras, assets, and alerts into one cloud console with access control and workflows."
      },
      actions: {
        console: "View console",
        features: "View features"
      },
      cardAria: "GIS monitoring demo",
      cardTag: "Map-first Console (demo)",
      cardTitle: "Site overview",
      mapAria: "Map mockup (replace with real map/screenshot)",
      badge1: "CAM-021 | Gate",
      badge2: "CAM-113 | Intersection",
      badge3: "CAM-044 | Parking",
      badge4: "Event | Loitering (demo)",
      cardNote: "* Replace with your real console screenshot (map, camera points, event panel)."
    },
    features: {
      title: "Core features",
      desc: "Put video into geographic context: not just what you see, but where it is and what it impacts.",
      card1: {
        tag: "GIS",
        title: "Map-based asset management",
        desc: "Cameras, sites, devices, and zones in GIS for fast search and control.",
        list1: "Points / areas / routes",
        list2: "Multi-site switching",
        list3: "Visual layers"
      },
      card2: {
        tag: "Video AI",
        title: "Cloud video analytics",
        desc: "Detect events and custom rules to turn anomalies into trackable incidents.",
        list1: "Event detection and tagging",
        list2: "Timeline replay and search",
        list3: "Extensible models"
      },
      card3: {
        tag: "Ops",
        title: "Alerts and workflows",
        desc: "Push incidents to groups, tickets, or systems with traceable handling.",
        list1: "Webhook / notification integrations",
        list2: "Severity and assignment",
        list3: "Audit logs and reports"
      }
    },
    console: {
      title: "Console design",
      desc: "Map-first UI with event panels and video wall for faster response.",
      card1: {
        tag: "Map-first",
        title: "Map + event panel",
        desc: "See assets and incidents at a glance with filters and search.",
        list1: "Event list / hotspots / impact area",
        list2: "Quick camera focus",
        list3: "One-click report export"
      },
      card2: {
        tag: "Video Wall",
        title: "Video wall and playback",
        desc: "Monitor multiple streams with timeline replay and event clips.",
        list1: "Multi-stream layouts",
        list2: "Event clips and annotations",
        list3: "Retention strategies"
      }
    },
    architecture: {
      title: "Architecture & deployment",
      desc: "Cloud-native and scalable from pilots to multi-site, multi-tenant rollouts.",
      card1: {
        tag: "Security",
        title: "Access control & tenancy",
        desc: "Role- and site-based permissions for cameras and events."
      },
      card2: {
        tag: "Scale",
        title: "Elastic scale",
        desc: "Scale sites and concurrency with flexible storage and analytics resources."
      },
      card3: {
        tag: "Integrations",
        title: "Integrate with your stack",
        desc: "Events, points, and video metadata via APIs and Webhooks."
      }
    },
    scenes: {
      title: "Scenarios",
      desc: "City ops, campuses, construction sites, logistics, public safety—anywhere you need map + video + events.",
      card1: {
        tag: "City",
        title: "City operations & safety",
        desc: "Use GIS to track incident locations, hotspots, and trends."
      },
      card2: {
        tag: "Campus",
        title: "Campus / facility",
        desc: "Track assets and alerts on the map with auditing."
      },
      card3: {
        tag: "Logistics",
        title: "Logistics sites & perimeters",
        desc: "Unified management for gates, traffic, and anomalies."
      }
    },
    cta: {
      title: "Build a GIS monitoring hub?",
      desc: "Start with a PoC site and expand once maps, points, and workflows are proven.",
      note: "(Replace with a form, email, Line, or contact info.)",
      demo: "Book a Demo",
      back: "Back to features"
    },
    footer: {
      copyright: "© <span id=\"y\"></span> NextVideo. Powered by CloudParty.",
      tagline: "GIS · Cloud Video · Events · Alerts · Access Control"
    }
  }
};

const setText = (el, value) => {
  if (el.dataset.i18nHtml) {
    el.innerHTML = value;
  } else {
    el.textContent = value;
  }
};

const resolveLang = () => {
  const stored = localStorage.getItem("lang");
  if (stored && i18n[stored]) return stored;
  const navLang = (navigator.language || "zh-Hant").toLowerCase();
  if (navLang.startsWith("zh")) return "zh-Hant";
  return "en";
};

const applyLanguage = (lang) => {
  const dict = i18n[lang] || i18n["zh-Hant"];

  document.documentElement.lang = lang === "en" ? "en" : "zh-Hant";
  if (dict.meta && dict.meta.title) document.title = dict.meta.title;
  const metaDesc = document.getElementById("meta-desc");
  if (metaDesc && dict.meta && dict.meta.desc) metaDesc.setAttribute("content", dict.meta.desc);

  document.querySelectorAll("[data-i18n]").forEach((el) => {
    const key = el.dataset.i18n;
    const value = key.split(".").reduce((acc, cur) => (acc ? acc[cur] : null), dict);
    if (value !== null && value !== undefined) setText(el, value);
  });

  document.querySelectorAll("[data-i18n-html]").forEach((el) => {
    const key = el.dataset.i18nHtml;
    const value = key.split(".").reduce((acc, cur) => (acc ? acc[cur] : null), dict);
    if (value !== null && value !== undefined) setText(el, value);
  });

  document.querySelectorAll("[data-i18n-attr]").forEach((el) => {
    const mapping = el.dataset.i18nAttr.split(",").map((pair) => pair.trim());
    mapping.forEach((pair) => {
      const parts = pair.split(":").map((v) => v.trim());
      const attr = parts[0];
      const key = parts[1];
      if (!attr || !key) return;
      const value = key.split(".").reduce((acc, cur) => (acc ? acc[cur] : null), dict);
      if (value !== null && value !== undefined) el.setAttribute(attr, value);
    });
  });

  document.querySelectorAll(".langBtn").forEach((btn) => {
    btn.classList.toggle("is-active", btn.dataset.lang === lang);
  });

  localStorage.setItem("lang", lang);
  document.dispatchEvent(new CustomEvent("language:change", { detail: { lang } }));
};

document.querySelectorAll(".langBtn").forEach((btn) => {
  btn.addEventListener("click", () => applyLanguage(btn.dataset.lang));
});

applyLanguage(resolveLang());
